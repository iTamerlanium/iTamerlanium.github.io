{"version":3,"sources":["../src/index.es6"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["/**\n * External Dependencies\n */\nimport React from 'react';\nimport createFragment from 'react-addons-create-fragment';\n\n/**\n * Internal Dependencies\n */\nimport tokenize from './tokenize';\n\nlet currentMixedString;\n\nfunction getCloseIndex( openIndex, tokens ) {\n\tvar openToken = tokens[ openIndex ],\n\t\tnestLevel = 0,\n\t\ttoken, i;\n\tfor ( i = openIndex + 1; i < tokens.length; i++ ) {\n\t\ttoken = tokens[ i ];\n\t\tif ( token.value === openToken.value ) {\n\t\t\tif ( token.type === 'componentOpen' ) {\n\t\t\t\tnestLevel++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( token.type === 'componentClose' ) {\n\t\t\t\tif ( nestLevel === 0 ) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t\tnestLevel--;\n\t\t\t}\n\t\t}\n\t}\n\t// if we get this far, there was no matching close token\n\tthrow new Error( 'Missing closing component token `' + openToken.value + '`' );\n}\n\nfunction buildChildren( tokens, components ) {\n\tvar children = [],\n\t\tchildrenObject = {},\n\t\topenComponent, clonedOpenComponent, openIndex, closeIndex, token, i, grandChildTokens, grandChildren, siblingTokens, siblings;\n\n\tfor ( i = 0; i < tokens.length; i++ ) {\n\t\ttoken = tokens[ i ];\n\t\tif ( token.type === 'string' ) {\n\t\t\tchildren.push( token.value );\n\t\t\tcontinue;\n\t\t}\n\t\t// component node should at least be set\n\t\tif ( ! components.hasOwnProperty( token.value ) || typeof components[ token.value ] === 'undefined' ) {\n\t\t\tthrow new Error( 'Invalid interpolation, missing component node: `' + token.value + '`' );\n\t\t}\n\t\t// should be either ReactElement or null (both type \"object\"), all other types deprecated\n\t\tif ( typeof components[ token.value ] !== 'object' ) {\n\t\t\tthrow new Error( 'Invalid interpolation, component node must be a ReactElement or null: `' + token.value + '`', '\\n> ' + currentMixedString );\n\t\t}\n\t\t// we should never see a componentClose token in this loop\n\t\tif ( token.type === 'componentClose' ) {\n\t\t\tthrow new Error( 'Missing opening component token: `' + token.value + '`' );\n\t\t}\n\t\tif ( token.type === 'componentOpen' ) {\n\t\t\topenComponent = components[ token.value ];\n\t\t\topenIndex = i;\n\t\t\tbreak;\n\t\t}\n\t\t// componentSelfClosing token\n\t\tchildren.push( components[ token.value ] );\n\t\tcontinue;\n\t}\n\n\tif ( openComponent ) {\n\t\tcloseIndex = getCloseIndex( openIndex, tokens );\n\t\tgrandChildTokens = tokens.slice( ( openIndex + 1 ), closeIndex );\n\t\tgrandChildren = buildChildren( grandChildTokens, components );\n\t\tclonedOpenComponent = React.cloneElement( openComponent, {}, grandChildren );\n\t\tchildren.push( clonedOpenComponent );\n\n\t\tif ( closeIndex < tokens.length - 1 ) {\n\t\t\tsiblingTokens = tokens.slice( closeIndex + 1 );\n\t\t\tsiblings = buildChildren( siblingTokens, components );\n\t\t\tchildren = children.concat( siblings );\n\t\t}\n\t}\n\n\tif ( children.length === 1 ) {\n\t\treturn children[ 0 ];\n\t}\n\n\tchildren.forEach( ( child, index ) => {\n\t\tif ( child ) {\n\t\t\tchildrenObject[ `interpolation-child-${index}` ] = child;\n\t\t}\n\t} );\n\n\treturn createFragment( childrenObject );\n}\n\nfunction interpolate( options ) {\n\tconst { mixedString, components, throwErrors } = options;\n\n\tcurrentMixedString = mixedString;\n\n\tif ( ! components ) {\n\t\treturn mixedString;\n\t}\n\n\tif ( typeof components !== 'object' ) {\n\t\tif ( throwErrors ) {\n\t\t\tthrow new Error( `Interpolation Error: unable to process \\`${ mixedString }\\` because components is not an object` );\n\t\t}\n\n\t\treturn mixedString;\n\t}\n\n\tlet tokens = tokenize( mixedString );\n\n\ttry {\n\t\treturn buildChildren( tokens, components );\n\t} catch ( error ) {\n\t\tif ( throwErrors ) {\n\t\t\tthrow new Error( `Interpolation Error: unable to process \\`${ mixedString }\\` because of error \\`${ error.message }\\`` );\n\t\t}\n\n\t\treturn mixedString;\n\t}\n};\n\nexport default interpolate;\n"]}